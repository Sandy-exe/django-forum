{% extends 'base.html' %}
{% load comment_helpers %}
{% load user_helpers %}
{% block content %}

<form action="?" method="post">
  {% csrf_token %}
  <input type="submit" class="primary button radius" value="Back to {{ view.kwargs.channel }}" name="back">
  <button type="button" class="button float-right radius" data-reveal-id="newComment">Create a new comment</button>
  {% if view.kwargs|is_owner:user.get_username or perms.forumapp.delete_thread %}
      <input type="submit" class="alert button float-right radius" value="Delete this thread" name="delete">
  {% endif %}
</form>

{% if request.user|is_banned_from:view.kwargs.channel %}
    <p>Sorry, this channel is unavailable.</p>
{% else %}
    <h2>{{ view.kwargs|get_thread_name }}</h2>
    <h4>{{ view.kwargs|description }}</h4>
    <ul>
    {% for listing in comment_list|dictsortreversed:'pub_date' %}
        <li>
            {{ listing.text }} by {% include 'forumapp/user_listing.html' %}
            at {{ listing.pub_date|date:"g:i" }}
            {% if not listing|is_recent %}
                  on {{ listing.pub_date|date:"D, d M, Y" }}
            {% endif %}
        </li>
    {% empty %}
        <p>No comments are available.</p>
    {% endfor %}
    </ul>
{% endif %}


<div class="reveal-modal" id="newComment" data-reveal>
	<h3>Create a new comment:</h3>
	<form action="#" method="post">
		{% csrf_token %}
	  	{{ form }}
		<input type="submit" class="success button float-right radius" value="Create Comment" name="create">
	</form>
  {% include "forumapp/messages.html" %}
	<a class="close-reveal-modal radius" aria-label="Close">&#215;</a>
</div>
{% endblock %}
